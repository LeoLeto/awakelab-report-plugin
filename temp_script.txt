echo '<script type="text/javascript">';
echo 'function updateIncludeCheckboxes() {';
echo '    console.log("=== updateIncludeCheckboxes called ===");';
echo '    var checkboxes = document.querySelectorAll(".category-checkbox");';
echo '    console.log("Found checkboxes:", checkboxes.length);';
echo '    ';
echo '    checkboxes.forEach(function(checkbox) {';
echo '        var tr = checkbox.closest("tr");';
echo '        if (!tr) return;';
echo '        var rowRadio = tr.querySelector(".final-exam-radio");';
echo '        var shouldDisable = rowRadio && rowRadio.checked;';
echo '        console.log("Checkbox value:", checkbox.value, "shouldDisable:", shouldDisable, "radio checked:", rowRadio ? rowRadio.checked : "no radio");';
echo '        ';
echo '        if (shouldDisable) {';
echo '            console.log("Disabling checkbox with value:", checkbox.value);';
echo '            checkbox.disabled = true;';
echo '            checkbox.checked = false;';
echo '            checkbox.style.opacity = "0.5";';
echo '            checkbox.style.cursor = "not-allowed";';
echo '            checkbox.style.pointerEvents = "none";';
echo '        } else {';
echo '            console.log("Enabling checkbox with value:", checkbox.value);';
echo '            checkbox.disabled = false;';
echo '            checkbox.style.opacity = "1";';
echo '            checkbox.style.cursor = "auto";';
echo '            checkbox.style.pointerEvents = "auto";';
echo '        }';
echo '        console.log("After update - disabled:", checkbox.disabled, "checked:", checkbox.checked, "pointerEvents:", checkbox.style.pointerEvents);';
echo '    });';
echo '}';
echo '';
echo '// Radio-button behavior for final exam selection';
echo 'document.addEventListener("DOMContentLoaded", function() {';
echo '    console.log("=== DOMContentLoaded fired ===");';
echo '    var finalExamRadios = document.querySelectorAll(".final-exam-radio");';
echo '    var categoryCheckboxes = document.querySelectorAll(".category-checkbox");';
echo '    console.log("Found radios:", finalExamRadios.length, "checkboxes:", categoryCheckboxes.length);';
echo '    ';
echo '    finalExamRadios.forEach(function(radio) {';
echo '        radio.addEventListener("change", function() {';
echo '            console.log("Radio changed:", this.value, "checked:", this.checked);';
echo '            if (this.checked) {';
echo '                finalExamRadios.forEach(function(r) {';
echo '                    if (r !== radio) {';
echo '                        r.checked = false;';
echo '                    }';
echo '                });';
echo '            }';
echo '            updateIncludeCheckboxes();';
echo '        });';
echo '    });';
echo '    ';
echo '    // Prevent changes to disabled checkboxes';
echo '    categoryCheckboxes.forEach(function(checkbox) {';
echo '        checkbox.addEventListener("click", function(e) {';
echo '            console.log("Checkbox clicked:", this.value, "disabled:", this.disabled);';
echo '            if (this.disabled) {';
echo '                console.log("Preventing click on disabled checkbox");';
echo '                e.preventDefault();';
echo '                e.stopPropagation();';
echo '                return false;';
echo '            }';
echo '        });';
echo '        checkbox.addEventListener("change", function(e) {';
echo '            console.log("Checkbox change event:", this.value, "disabled:", this.disabled);';
echo '            if (this.disabled) {';
echo '                console.log("Preventing change on disabled checkbox");';
echo '                e.preventDefault();';
echo '                this.checked = false;';
echo '                return false;';
echo '            }';
echo '        });';
echo '    });';
echo '    ';
echo '    updateIncludeCheckboxes();';
echo '});';
echo '</script>';
